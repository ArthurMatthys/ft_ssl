image : python:3.6

before_script:
    - python3 -V

variables:
  GIT_SUBMODULE_STRATEGY: recursive

stages:
    - build
    - test

build:
    stage: build
    tags:
        - osx
    script:
        - make

test:
    stage: test
    tags:
        - osx
        - python3
    script:
        - python3 run_test.py
    coverage: /TOTAL\s+\d+\s+\d+\s+(\d+)%$/
